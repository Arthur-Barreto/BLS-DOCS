
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://arthur-barreto.github.io/BLS-DOCS/implementation/">
      
      
        <link rel="prev" href="../results/">
      
      
        <link rel="next" href="../contributing/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Implementation - SRP Illinois 2024</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#implementation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SRP Illinois 2024" class="md-header__button md-logo" aria-label="SRP Illinois 2024" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SRP Illinois 2024
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Implementation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Arthur-Barreto/BLS-DOCS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    BLS-DOCS
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../bls/" class="md-tabs__link">
        
  
    
  
  BLS

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../results/" class="md-tabs__link">
        
  
    
  
  Results

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Implementation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contributing/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SRP Illinois 2024" class="md-nav__button md-logo" aria-label="SRP Illinois 2024" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SRP Illinois 2024
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Arthur-Barreto/BLS-DOCS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    BLS-DOCS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BLS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Core Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-function-descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      Detailed Function Descriptions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed Function Descriptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#min_value" class="md-nav__link">
    <span class="md-ellipsis">
      min_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_value" class="md-nav__link">
    <span class="md-ellipsis">
      max_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ptp" class="md-nav__link">
    <span class="md-ellipsis">
      ptp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arange" class="md-nav__link">
    <span class="md-ellipsis">
      arange
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linspace" class="md-nav__link">
    <span class="md-ellipsis">
      linspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_phase" class="md-nav__link">
    <span class="md-ellipsis">
      auto_phase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_max_min_period" class="md-nav__link">
    <span class="md-ellipsis">
      auto_max_min_period
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_period" class="md-nav__link">
    <span class="md-ellipsis">
      auto_period
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spec_generator" class="md-nav__link">
    <span class="md-ellipsis">
      spec_generator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spec_generator_gambiarra" class="md-nav__link">
    <span class="md-ellipsis">
      spec_generator_gambiarra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_trel" class="md-nav__link">
    <span class="md-ellipsis">
      compute_trel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#normalize" class="md-nav__link">
    <span class="md-ellipsis">
      normalize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_weights" class="md-nav__link">
    <span class="md-ellipsis">
      compute_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bls" class="md-nav__link">
    <span class="md-ellipsis">
      bls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readcsv" class="md-nav__link">
    <span class="md-ellipsis">
      readCSV
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequential-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Sequential Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmp-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      OpenMP Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpi-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      MPI Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stapl-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      STAPL Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytorch-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      PyTorch Implementation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="implementation">Implementation</h1>
<p>This page provides a guide for each version of the BLS (Box Least Squares) algorithm, including implementations in sequential, OpenMP, MPI, STAPL, and PyTorch. Each section offers a detailed explanation of the respective implementation, including descriptions of functions and key components.</p>
<h2 id="overview">Overview</h2>
<p>The following structs are used throughout the implementation, for defining functions types:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">PERIODParameters</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">minimum_period</span><span class="p">;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">maximum_period</span><span class="p">;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">total_duration</span><span class="p">;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">};</span>
</code></pre></div>
<ul>
<li><code>PERIODParameters</code> holds the range of periods and the total time duration for the analysis.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">BLSResult</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">best_period</span><span class="p">;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">best_duration</span><span class="p">;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">best_phase</span><span class="p">;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">best_d_value</span><span class="p">;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">};</span>
</code></pre></div>
<ul>
<li><code>BLSResult</code> stores the results of the BLS algorithm, including the best period, best duration, best phase, and the lowest d-value (the metrics used to evaluate the best fit).</li>
</ul>
<p>Additionally, the following typedef is used in the implementation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">typedef</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SPECParameters</span><span class="p">;</span>
</code></pre></div>
<h3 id="core-functions">Core Functions</h3>
<table>
<thead>
<tr>
<th>Function name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#id_min_value"><code>min_value</code></a></td>
<td>Returns the minimum value in a vector.</td>
</tr>
<tr>
<td><a href="#id_max_value"><code>max_value</code></a></td>
<td>Returns the maximum value in a vector.</td>
</tr>
<tr>
<td><a href="#id_ptp"><code>ptp</code></a></td>
<td>Returns the peak-to-peak value in a vector.</td>
</tr>
<tr>
<td><a href="#id_arange"><code>arange</code></a></td>
<td>Generates a range of values.</td>
</tr>
<tr>
<td><a href="#id_linspace"><code>linspace</code></a></td>
<td>Generates a linearly spaced range of values.</td>
</tr>
<tr>
<td><a href="#id_auto_phase"><code>auto_phase</code></a></td>
<td>Generates a phase vector.</td>
</tr>
<tr>
<td><a href="#id_auto_max_min_period"><code>auto_max_min_period</code></a></td>
<td>Generates the maximum and minimum period.</td>
</tr>
<tr>
<td><a href="#id_auto_period"><code>auto_period</code></a></td>
<td>Generates a period vector.</td>
</tr>
<tr>
<td><a href="#id_spec_generator"><code>spec_generator</code></a></td>
<td>Generates a vector of SPEC parameters.</td>
</tr>
<tr>
<td><a href="#id_spec_generator_gambiarra"><code>spec_generator_gambiarra</code></a></td>
<td>Generates a vector of SPEC parameters.</td>
</tr>
<tr>
<td><a href="#id_compute_trel"><code>compute_trel</code></a></td>
<td>Computes the relative time vector.</td>
</tr>
<tr>
<td><a href="#id_normalize"><code>normalize</code></a></td>
<td>Normalizes a vector.</td>
</tr>
<tr>
<td><a href="#id_compute_weights"><code>compute_weights</code></a></td>
<td>Computes the weights vector.</td>
</tr>
<tr>
<td><a href="#id_model"><code>model</code></a></td>
<td>Computes the model for the BLS algorithm.</td>
</tr>
<tr>
<td><a href="#id_bls"><code>bls</code></a></td>
<td>Computes the BLS algorithm.</td>
</tr>
<tr>
<td><a href="#id_readCSV"><code>readCSV</code></a></td>
<td>Reads a CSV file.</td>
</tr>
</tbody>
</table>
<h3 id="detailed-function-descriptions">Detailed Function Descriptions</h3>
<p><a name="id_min_value"></p>
<h4 id="min_value"><code>min_value</code></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">min_value</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
Get the minimum element in a vector.</p>
<p><strong>Parameters:</strong>  </p>
<ul>
<li><strong><code>T</code></strong> Type of the elements in the vector.</li>
<li><strong><code>v</code></strong> The vector from which to get the minimum value</li>
</ul>
<p><strong>Returns:</strong><br />
  The minimum element in the vector.</p>
<hr />
<p><a name= "id_max_value"></p>
<h4 id="max_value"><code>max_value</code></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">max_value</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Get the maximum element in a vector.</p>
<p><strong>Parameters:</strong>  </p>
<ul>
<li><strong><code>T</code></strong> Type of the elements in the vector.</li>
<li><strong><code>v</code></strong> The vector from which to get the maximum value</li>
</ul>
<p><strong>Returns:</strong>
  The maximum element in the vector.</p>
<hr />
<p><a name="id_ptp"></p>
<h4 id="ptp"><code>ptp</code></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">ptp</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Get the peak-to-peak value in a vector, which is the difference between the maximum and minimum values.</p>
<p><strong>Parameters:</strong>  </p>
<ul>
<li><strong><code>T</code></strong> Type of the elements in the vector.</li>
<li><strong><code>v</code></strong> The vector from which to get the peak-to-peak value</li>
</ul>
<p><strong>Returns:</strong>
  The peak-to-peak value in the vector.</p>
<hr />
<p><a name="id_arange"></p>
<h4 id="arange">arange</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">arange</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">step</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Generates a range of values from <code>start</code> to <code>end</code> with a given step size. It's similar to the <code>numpy.arange</code> function in Python.</p>
<p><strong>Parameters:</strong>  </p>
<ul>
<li><strong><code>start</code></strong> The starting value of the range.</li>
<li><strong><code>end</code></strong> The ending value of the range, not inclusive.</li>
<li><strong><code>step</code></strong> The step size between values.</li>
</ul>
<p><strong>Returns:</strong>
  A vector of values from <code>start</code> to <code>end</code> with a step size of <code>step</code>.</p>
<hr />
<p><a name="id_linspace"></p>
<h4 id="linspace">linspace</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">linspace</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Generates a linearly spaced range of values from <code>start</code> to <code>end</code> with a given number of elements. It's similar to the <code>numpy.linspace</code> function in Python.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>start</code></strong> The starting value of the range.</li>
<li><strong><code>end</code></strong> The ending value of the range.</li>
<li><strong><code>num</code></strong> The number of elements in the range.</li>
</ul>
<p><strong>Returns:</strong>
  A vector of <code>num</code> values from <code>start</code> to <code>end</code>.</p>
<hr />
<p><a name="id_auto_phase"></p>
<h4 id="auto_phase">auto_phase</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">auto_phase</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">period</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">duration</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Generates a vector os phases for a given period and duration. It's the cpp version of the <code>auto_phase</code> function from <code>astropy</code>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>period</code></strong> The period of the signal.</li>
<li><strong><code>duration</code></strong> The duration of the signal.</li>
</ul>
<p><strong>Returns:</strong>
  A vector of phases.</p>
<hr />
<p><a name="id_auto_max_min_period"></p>
<h4 id="auto_max_min_period">auto_max_min_period</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">PERIODParameters</span><span class="w"> </span><span class="nf">auto_max_min_period</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Generates the maximum and minimum period for a given time vector. It's the cpp version of the <code>auto_max_min_period</code> function from <code>astropy</code>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>time</code></strong> The time vector.</li>
</ul>
<p><strong>Returns:</strong>
  A <code>PERIODParameters</code> struct with the minimum period, maximum period, and total duration of the time vector (it's the <code>ptp</code> of the time vector).</p>
<hr />
<p><a name="id_auto_period"></p>
<h4 id="auto_period">auto_period</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">auto_period</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">minimum_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">                                </span><span class="kt">double</span><span class="w"> </span><span class="n">maximum_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">                                </span><span class="kt">double</span><span class="w"> </span><span class="n">total_duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Generates a vector of periods, given the minimum period, maximum period, and total duration. It's the cpp version of the <code>auto_period</code> function from <code>astropy</code>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>minimum_period</code></strong> The minimum period.</li>
<li><strong><code>maximum_period</code></strong> The maximum period.</li>
<li><strong><code>total_duration</code></strong> The total duration.</li>
</ul>
<p><strong>Returns:</strong>
  A vector of periods.</p>
<hr />
<p><a name="id_spec_generator"></p>
<h4 id="spec_generator">spec_generator</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">SPECParameters</span><span class="o">&gt;</span><span class="w"> </span><span class="n">spec_generator</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
Generates a vector of <code>SPECParameters</code> for a given time vector. This function is used to generate the candidates for running the BLS algorithm. However, it currently needs improvements as it generates a large number of candidates.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>time</code></strong> The time vector.</li>
</ul>
<p><strong>Returns:</strong>
  A vector of <code>SPECParameters</code>, which are tuples of <code>(period, duration, phase)</code>, the candidates for the BLS algorithm.</p>
<hr />
<p><a name="id_spec_generator_gambiarra"></p>
<h4 id="spec_generator_gambiarra">spec_generator_gambiarra</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">SPECParameters</span><span class="o">&gt;</span><span class="w"> </span><span class="n">spec_generator_gambiarra</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong>
It's the simple version of the <code>spec_generator</code> function. It generates a vector of <code>SPECParameters</code> for a given time vector. This function is used to generate the candidates for running the BLS algorithm.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>time</code></strong> The time vector.</li>
</ul>
<p><strong>Returns:</strong>
  A vector of <code>SPECParameters</code>, which are tuples of <code>(period, duration, phase)</code>, the candidates for the BLS algorithm.</p>
<hr />
<p><a name="id_compute_trel"></p>
<h4 id="compute_trel">compute_trel</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute_trel</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
The <code>compute_trel</code> function calculates the relative time vector. It subtracts the minimum value of the time vector (<code>t0</code>) from each element, returning a vector of relative times. This is useful for normalizing the time data for further processing.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>time</code></strong><br />
  A vector of time values (<code>std::vector&lt;double&gt;</code>), typically representing the time data.</li>
</ul>
<p><strong>Returns:</strong><br />
  A vector of relative time values (<code>std::vector&lt;double&gt;</code>), where each value is the difference between the corresponding time and the minimum value in the input time vector.</p>
<hr />
<p><a name="id_normalize"></p>
<h4 id="normalize">normalize</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
The <code>normalize</code> function takes a vector of flux values and normalizes them by subtracting the mean and dividing by the standard deviation. This is useful for transforming the flux data to have a mean of 0 and standard deviation of 1, which is common in many data analysis techniques.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>flux</code></strong><br />
  A vector of flux values (<code>std::vector&lt;double&gt;</code>), representing the signal data.</li>
</ul>
<p><strong>Returns:</strong><br />
  A normalized vector of flux values (<code>std::vector&lt;double&gt;</code>), where each value is the original flux value minus the mean, divided by the standard deviation.</p>
<hr />
<p><a name="id_compute_weights"></p>
<h4 id="compute_weights">compute_weights</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute_weights</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux_err</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
The <code>compute_weights</code> function calculates the weights based on the provided flux errors. The weights are computed as the inverse square of the flux errors and are normalized so that their sum is 1. This is commonly used in weighted averaging or fitting algorithms where data points have different uncertainties.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>flux_err</code></strong><br />
  A vector of flux error values (<code>std::vector&lt;double&gt;</code>), representing the uncertainty in the flux measurements.</li>
</ul>
<p><strong>Returns:</strong><br />
  A vector of normalized weights (<code>std::vector&lt;double&gt;</code>), where each weight is inversely proportional to the square of the corresponding flux error and normalized so that the sum of the weights is 1.</p>
<hr />
<p><a name="id_model"></p>
<h4 id="model">model</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kt">double</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">t_rel</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux</span><span class="p">,</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">             </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">weights</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">period</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">duration</span><span class="p">,</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">             </span><span class="kt">double</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
The <code>model</code> function is crucial as it evaluates the metrics to determine the presence of a transit. It assesses a transit model using the provided time, flux, weights, period, duration, and phase. By calculating the occurrence of a transit at each point in the time vector and applying weighted averages, it computes a goodness-of-fit metric (<code>d_value</code>). This metric is essential for identifying the best-fitting transit model.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>t_rel</code></strong><br />
  A vector of relative time values (<code>std::vector&lt;double&gt;</code>), which represents the time data normalized by subtracting the minimum value.</p>
</li>
<li>
<p><strong><code>flux</code></strong><br />
  A vector of flux values (<code>std::vector&lt;double&gt;</code>), representing the observed light curve data.</p>
</li>
<li>
<p><strong><code>weights</code></strong><br />
  A vector of weights (<code>std::vector&lt;double&gt;</code>), computed from the flux errors.</p>
</li>
<li>
<p><strong><code>period</code></strong><br />
  The period of the transit event (in the same units as the time vector).</p>
</li>
<li>
<p><strong><code>duration</code></strong><br />
  The duration of the transit event.</p>
</li>
<li>
<p><strong><code>phase</code></strong><br />
  The phase of the transit event, specifying where in the period the transit occurs.</p>
</li>
</ul>
<p><strong>Returns:</strong><br />
  A <code>double</code> representing the calculated goodness-of-fit metric (<code>d_value</code>) for the given transit model. This value is useful for determining how well a transit model fits the data.</p>
<hr />
<p><a name="id_bls"></p>
<h4 id="bls">bls</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">BLSResult</span><span class="w"> </span><span class="nf">bls</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux</span><span class="p">,</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux_err</span><span class="p">,</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">SPECParameters</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s_params</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
The <code>bls</code> function implements the Box Least Squares (BLS) algorithm for detecting periodic transit-like events in a time series of flux measurements. It evaluates various candidate models based on the input parameters (period, duration, and phase) and returns the model that best fits the data, according to a goodness-of-fit metric (<code>d_value</code>).</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>time</code></strong><br />
  A vector of time values (<code>std::vector&lt;double&gt;</code>), representing the time data for the light curve.</p>
</li>
<li>
<p><strong><code>flux</code></strong><br />
  A vector of flux values (<code>std::vector&lt;double&gt;</code>), representing the observed light curve data.</p>
</li>
<li>
<p><strong><code>flux_err</code></strong><br />
  A vector of flux error values (<code>std::vector&lt;double&gt;</code>), representing the uncertainty in the flux measurements.</p>
</li>
<li>
<p><strong><code>s_params</code></strong><br />
  A vector of <code>SPECParameters</code> (<code>std::vector&lt;SPECParameters&gt;</code>), which are tuples of <code>(period, duration, phase)</code> representing the candidate transit models to evaluate.</p>
</li>
</ul>
<p><strong>Returns:</strong><br />
  A <code>BLSResult</code> structure, which contains the following:</p>
<ul>
<li>
<p><strong><code>best_d_value</code></strong><br />
  The best goodness-of-fit metric (<code>double</code>) found during the search.</p>
</li>
<li>
<p><strong><code>best_period</code></strong><br />
  The period (<code>double</code>) of the best-fitting transit model.</p>
</li>
<li>
<p><strong><code>best_duration</code></strong><br />
  The duration (<code>double</code>) of the best-fitting transit model.</p>
</li>
<li>
<p><strong><code>best_phase</code></strong><br />
  The phase (<code>double</code>) of the best-fitting transit model.</p>
</li>
</ul>
<hr />
<p><a name="id_readCSV"></p>
<h4 id="readcsv">readCSV</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">readCSV</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time</span><span class="p">,</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">             </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flux_err</span><span class="p">);</span>
</code></pre></div>
<p><strong>Description</strong><br />
The <code>readCSV</code> function reads a CSV file and extracts the time, flux, and flux error values into the provided vectors. The function assumes that the CSV file contains at least three columns (time, flux, and flux error) and that the first line is a header.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>filename</code></strong><br />
  A <code>string</code> representing the path to the CSV file.</p>
</li>
<li>
<p><strong><code>time</code></strong><br />
  A vector of time values (<code>std::vector&lt;double&gt;</code>), which will be filled with the time data from the file.</p>
</li>
<li>
<p><strong><code>flux</code></strong><br />
  A vector of flux values (<code>std::vector&lt;double&gt;</code>), which will be filled with the flux data from the file.</p>
</li>
<li>
<p><strong><code>flux_err</code></strong><br />
  A vector of flux error values (<code>std::vector&lt;double&gt;</code>), which will be filled with the flux error data from the file.</p>
</li>
</ul>
<p><strong>Returns:</strong><br />
  This function does not return a value, but it populates the provided <code>time</code>, <code>flux</code>, and <code>flux_err</code> vectors with data from the CSV file. If the file cannot be opened, an error message is printed to <code>stderr</code>.</p>
<hr />
<h2 id="sequential-implementation">Sequential Implementation</h2>
<h2 id="openmp-implementation">OpenMP Implementation</h2>
<h2 id="mpi-implementation">MPI Implementation</h2>
<h2 id="stapl-implementation">STAPL Implementation</h2>
<h2 id="pytorch-implementation">PyTorch Implementation</h2>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2024 <a href='https://github.com/Arthur-Barreto' target='_blank' rel='noopener'>Arthur Barreto</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Arthur-Barreto" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/arthur-martins-de-souza-barreto/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>